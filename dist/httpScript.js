var httpScript=(()=>{var h=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var y=(e,o)=>{for(var n in o)h(e,n,{get:o[n],enumerable:!0})},O=(e,o,n,l)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of $(o))!P.call(e,s)&&s!==n&&h(e,s,{get:()=>o[s],enumerable:!(l=g(o,s))||l.enumerable});return e};var x=e=>O(h({},"__esModule",{value:!0}),e);var M={};y(M,{run:()=>A});var c={method:"GET",url:null,queries:{},headers:{},body:null,fileToSend:null,saveFile:null,state:{},js:null,runJs(response){this.js&&eval(this.js)}},m={g:"GET",p:"POST",u:"PUT",a:"PATCH",d:"DELETE",h:"HEAD",o:"OPTIONS",t:"TRACE",get:"GET",post:"POST",put:"PUT",patch:"PATCH",delete:"DELETE",head:"HEAD",options:"OPTIONS",trace:"TRACE"};function p(e){let o=e.toLowerCase(),n=m[o];if(!n)throw new Error(`Method '${e}' unknown!`);return n}function u(e){return e&&e.replace(/^:\d+/,"http://localhost$&").replace(/^localhost(:\d+)?/,"http://$&").replace(/^(?:[\w-]+\.)+[a-zA-Z]{2,}/m,"https://$&").replace(/^(?:\d{1,3}\.){3}\d{1,3}/m,"http://$&")}function E(e,o){let n={},l=e.matchAll(o);for(let[,s,r]of l)n[s]=r;return n}function v(e){let o={},n=/^([a-zA-Z]+) +(.*?)$/m;if(!n.test(e))throw new Error("Method or URL not found");let[,l,s]=e.match(n);if(e=e.replace(n,""),o.method=p(l),!s)throw new Error("URL is empty");if(o.url=u(s),/^\.body/m.test(e)){if(["GET","TRACE","HEAD"].includes(o.method))throw new Error(`Invalid ${o.method} method to send body`);let r=/^\.body\s*([\s\S]+?)\s*^\./m;if(!r.test(e))throw new Error("Invalid body (check if you forgot to close it with '.')");let[,t]=e.match(r);o.body=t,e=e.replace(r,"")}if(/^\.js/m.test(e)){let r=/^.js\s*([\s\S]+?)\s*^\./m;if(!r.test(e))throw new Error("Invalid js (check if you forgot to close it with '.')");let[,t]=e.match(r);e=e.replace(r,""),o.js=t}if(o.queries=E(e,/^(\S+?) *= *(.*?)$/gm),o.headers=E(e,/^(\S+?): *(.*?)$/gm),/^</m.test(e)){let r=/< (.+?)$/m;if(!r.test(e))throw new Error("File to send not specified");let t=["POST","PUT","PATCH","OPTIONS","DELETE"];if(!t.includes(o.method))throw new Error(`Invalid method (${o.method}), use one this: `+t.join(", "));let[,a]=e.match(r);o.fileToSend=a}if(/^>/m.test(e)){if(!/^> (.+?)$/m.test(e))throw new Error("File to save not specified");let[,t]=e.match(/^> (.+?)$/m);o.saveFile=t}return o}function w(e){return e.replace(/#.*$/gm,"").split(/^---/gm).map(v)}function T(e){let o=/(?<!\\)\$([_\w][_\w.]*)\b/g,n=/\\(\$[_\w][_\w.]*)\b/g;function l(r,t){let i=t.split("."),a=e.state;if(a==null)throw new Error(`Variable 'state' is ${a}`);for(let d of i){let f=a[d];if(f==null){let S=JSON.stringify(e.state,null,2);throw new Error(`Property '${d}' is ${f} on ${t} with ${S}`)}a=f}return a}function s(r,t=!1){for(let[i,a]of Object.entries(r)){if(i==="state"&&t)continue;let d=typeof a;d==="string"?(r[i]=a.replace(o,l),r[i]=r[i].replace(n,"$1")):d==="object"&&a!==null&&(r[i]=s(a))}return r}s(e,!0)}function A(e,o=l=>l,n={}){let l=w(e);n.default={...c};let s=null,r=null;for(let t of l)t.state=n,t={...t.state.default,...t,queries:{...t.state.default.queries,...t.queries},headers:{...t.state.default.headers,...t.headers}},(t.url.startsWith("http")||t.state.baseUrl!=null)&&(r=u(t.state.baseUrl)||new URL(t.url).origin),r!=null&&t.url.startsWith("/")&&(t.url=r+t.url),T(t),s=o(t),t.runJs(s),n={...n,...t.state};return s}return x(M);})();
